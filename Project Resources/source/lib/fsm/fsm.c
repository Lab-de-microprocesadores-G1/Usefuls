/***************************************************************************//**
  @file     fsm.c
  @brief    FSM Library
  @author   G. Davidov, F. Farall, J. Gaytan, L. Kammann, N. Trozzo
 ******************************************************************************/


/*******************************************************************************
 * INCLUDE HEADER FILES
 ******************************************************************************/

#include "fsm.h"

/*******************************************************************************
 * CONSTANT AND MACRO DEFINITIONS USING #DEFINE
 ******************************************************************************/


/*******************************************************************************
 * ENUMERATIONS AND STRUCTURES AND TYPEDEFS
 ******************************************************************************/

/*******************************************************************************
 * VARIABLES WITH GLOBAL SCOPE
 ******************************************************************************/

/*******************************************************************************
 * FUNCTION PROTOTYPES FOR PRIVATE FUNCTIONS WITH FILE LEVEL SCOPE
 ******************************************************************************/


/*******************************************************************************
 * ROM CONST VARIABLES WITH FILE LEVEL SCOPE
 ******************************************************************************/



/*******************************************************************************
 * STATIC VARIABLES AND CONST VARIABLES WITH FILE LEVEL SCOPE
 ******************************************************************************/


/*******************************************************************************
 *******************************************************************************
                        GLOBAL FUNCTION DEFINITIONS
 *******************************************************************************
 ******************************************************************************/

void fsmCycle(state_t* state, void* event)
{
	// Casting to the standard event handled
	event_id_t newEvent = EVENT_ID(event);

	// Searching the edge with this event
	state_t currentState = *state;
	while (currentState->event != newEvent && currentState->event != END_OF_STATE)
	{
		currentState++;
	}

	// When found the edge or the end of state
	currentState->action(event);

	// Go to the next state
	*state = currentState->nextState;
}

void __do_nothing__(void* event)
{

}

/*******************************************************************************
 *******************************************************************************
                        LOCAL FUNCTION DEFINITIONS
 *******************************************************************************
 ******************************************************************************/



/******************************************************************************/
