/********************************************************************************
  @file     App.c
  @brief    Application functions
  @author   N. Magliola, G. Davidov, F. Farall, J. Gayt√°n, L. Kammann, N. Trozzo
 *******************************************************************************/

/*******************************************************************************
 * INCLUDE HEADER FILES
 ******************************************************************************/

#include <stdio.h>

#include "board.h"
#include "drivers/MCAL/pwm_dma/pwm_dma.h"

/*******************************************************************************
 * CONSTANT AND MACRO DEFINITIONS USING #DEFINE
 ******************************************************************************/

#define BUFFER_SIZE         8 * 3 * 8 * 8

#define PRESCALER           1
#define MODULO              30

/*******************************************************************************
 * FUNCTION PROTOTYPES FOR PRIVATE FUNCTIONS WITH FILE LEVEL SCOPE
 ******************************************************************************/

/*******************************************************************************
 * PRIVATE VARIABLES WITH FILE LEVEL SCOPE
 ******************************************************************************/

static uint16_t     buffer[BUFFER_SIZE];

/*******************************************************************************
 *******************************************************************************
                        GLOBAL FUNCTION DEFINITIONS
 *******************************************************************************
 ******************************************************************************/

/* Called once at the beginning of the program */
void appInit (void)
{
    // Initialize PWM-DMA driver
    pwmdmaInit(PRESCALER, MODULO, FTM_INSTANCE_0, FTM_CHANNEL_0);

    // Fill the buffer
    for ( uint8_t i = 0 ; i < BUFFER_SIZE ; i++ )
    {
    	buffer[i] = 20;
    }

    // Start the DMA transfer on the PWM
    pwmdmaStart(buffer, BUFFER_SIZE, false);
}

/* Called repeatedly in an infinite loop */
void appRun (void)
{

}

/*******************************************************************************
 *******************************************************************************
                        LOCAL FUNCTION DEFINITIONS
 *******************************************************************************
 ******************************************************************************/


/*******************************************************************************
 ******************************************************************************/
